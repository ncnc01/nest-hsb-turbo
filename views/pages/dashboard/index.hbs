{{!-- 
  ëª¨ë˜ ì»´í¬ë„ŒíŠ¸ ê¸°ë°˜ ëŒ€ì‹œë³´ë“œ
  ê¸°ì¡´ 5562ì¤„ì—ì„œ ì•½ 200ì¤„ë¡œ ì¶•ì†Œ
--}}

<div class="space-y-6" id="dashboard-container">

  {{!-- ëŒ€ì‹œë³´ë“œ í—¤ë” --}}
  {{!-- {{> dashboard/dashboard-header 
    title="ëŒ€ì‹œë³´ë“œ" 
    description="ê´€ë¦¬ì íŒ¨ë„ ê°œìš” ë° í†µê³„"
    showExportBtn=true
    lastUpdated="ë°©ê¸ˆ ì „"
  }} --}}

  {{!-- í†µê³„ ì¹´ë“œ ê·¸ë¦¬ë“œ --}}
  <!-- í†µê³„ ì¹´ë“œë“¤ì€ JavaScriptì—ì„œ ë™ì ìœ¼ë¡œ ìƒì„± -->
  {{!-- <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6" id="stats-grid">
  </div> --}}

  {{!-- ì°¨íŠ¸ ì„¹ì…˜ --}}
  <div class="grid grid-cols-1 lg:grid-cols-2 gap-6" id="charts-grid">
    
    {{!-- ë¼ì¸ ì°¨íŠ¸ --}}
    {{> charts/chart-container 
      title="ë¬¸ì˜ ì²˜ë¦¬ ì¶”ì´" 
      chartId="trend-chart"
      description="ì›”ë³„ ë¬¸ì˜ ì ‘ìˆ˜ ë° ì²˜ë¦¬ í˜„í™©"
      showControls=true
      showLegend=true
      height="350px"
      defaultLibrary="chartjs"
    }}

    {{!-- ë°” ì°¨íŠ¸ --}}
    {{> charts/chart-container 
      title="ìš”ì¼ë³„ ë¬¸ì˜ëŸ‰" 
      chartId="daily-chart"
      description="ìš”ì¼ë³„ ë¬¸ì˜ ì ‘ìˆ˜ í˜„í™©"
      showControls=true
      height="350px"
      defaultLibrary="chartjs"
    }}

  </div>

  {{!-- ì¶”ê°€ ì°¨íŠ¸ ì„¹ì…˜ --}}
  <div class="grid grid-cols-1 lg:grid-cols-3 gap-6" id="additional-charts">
    
    {{!-- íŒŒì´ ì°¨íŠ¸ --}}
    {{> charts/chart-container 
      title="ë¬¸ì˜ ìƒíƒœ ë¶„í¬" 
      chartId="status-chart"
      showControls=true
      height="320px"
    }}

    {{!-- ì˜ì—­ ì°¨íŠ¸ --}}
    {{> charts/chart-container 
      title="ì‹œê°„ë³„ ë¬¸ì˜ëŸ‰" 
      chartId="hourly-chart"
      description="24ì‹œê°„ ê¸°ì¤€"
      showControls=true
      height="320px"
    }}

    {{!-- ì¶”ê°€ í†µê³„ --}}
    <div class="bg-white rounded-lg shadow-sm border border-gray-200 p-6">
      <h3 class="text-lg font-semibold text-gray-900 mb-4">ë¹ ë¥¸ í†µê³„</h3>
      <div class="space-y-4" id="quick-stats">
        <!-- ë¹ ë¥¸ í†µê³„ëŠ” JavaScriptì—ì„œ ë™ì ìœ¼ë¡œ ìƒì„± -->
      </div>
    </div>

  </div>

  {{!-- ê³ ê¸‰ ì°¨íŠ¸ ì„¹ì…˜ --}}
  <div class="grid grid-cols-1 lg:grid-cols-2 gap-6" id="advanced-charts">
    
    {{!-- ë²„ë¸” ì°¨íŠ¸ --}}
    {{> charts/chart-container 
      title="ë²„ë¸” ì°¨íŠ¸ - ë‹¤ì°¨ì› ë°ì´í„°" 
      chartId="bubble-chart"
      description="ë§¤ì¶œ, ì´ìµ, ì ìœ ìœ¨"
      showControls=true
      height="350px"
    }}

    {{!-- ë ˆì´ë” ì°¨íŠ¸ --}}
    {{> charts/chart-container 
      title="ë ˆì´ë” ì°¨íŠ¸ - ì„±ê³¼ ì§€í‘œ" 
      chartId="radar-chart"
      description="ë‹¤ê°ë„ ì„±ê³¼ ë¶„ì„"
      showControls=true
      height="350px"
    }}

  </div>

  {{!-- íŠ¹ìˆ˜ ì°¨íŠ¸ ì„¹ì…˜ --}}
  <div class="grid grid-cols-1 lg:grid-cols-2 gap-6" id="special-charts">
    
    {{!-- ê²Œì´ì§€ ì°¨íŠ¸ --}}
    {{> charts/chart-container 
      title="ê²Œì´ì§€ ì°¨íŠ¸ - ì™„ë£Œìœ¨" 
      chartId="gauge-chart"
      description="ëª©í‘œ ëŒ€ë¹„ ë‹¬ì„±ë¥ "
      showControls=true
      height="350px"
    }}

    {{!-- í¼ë„ ì°¨íŠ¸ --}}
    {{> charts/chart-container 
      title="í¼ë„ ì°¨íŠ¸ - ì „í™˜ìœ¨" 
      chartId="funnel-chart"
      description="ë‹¨ê³„ë³„ ì „í™˜ ê³¼ì •"
      showControls=true
      height="350px"
    }}

  </div>

  {{!-- ì°¨íŠ¸ ë¼ì´ë¸ŒëŸ¬ë¦¬ & íƒ€ì… ë¹„êµ ëŒ€ì‹œë³´ë“œ --}}
  <div class="bg-white rounded-lg shadow-sm border border-gray-200 mb-6">
    <div class="flex items-center justify-between mb-6 p-6 pb-0">
      <div>
        <h3 class="text-xl font-bold text-gray-900">ğŸ“Š ì°¨íŠ¸ ë¼ì´ë¸ŒëŸ¬ë¦¬ ë¹„êµ ëŒ€ì‹œë³´ë“œ</h3>
        <p class="text-gray-600 mt-1">ê° ë¼ì´ë¸ŒëŸ¬ë¦¬ë³„ íŠ¹ì„±ê³¼ ì°¨íŠ¸ íƒ€ì…ì„ ë¹„êµí•˜ì—¬ ìµœì ì˜ ì„ íƒì„ í•˜ì„¸ìš”</p>
      </div>
      <button 
        onclick="toggleChartComparisonTable()" 
        class="bg-gray-100 text-gray-700 px-3 py-1 rounded text-sm hover:bg-gray-200 transition-colors"
        id="chart-comparison-toggle"
      >
        <i class="fas fa-chevron-down mr-1"></i>ìƒì„¸ ë¹„êµ
      </button>
    </div>

    <div class="p-6 pt-0">
      <!-- Quick Overview Cards -->
      <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 mb-6">
        <div class="border border-gray-200 rounded-lg p-4 bg-blue-50">
          <div class="flex items-center justify-between mb-2">
            <h4 class="font-semibold text-blue-900">ğŸ† ì¶”ì²œ ë¼ì´ë¸ŒëŸ¬ë¦¬</h4>
            <span class="text-xs bg-blue-100 text-blue-800 px-2 py-1 rounded">ì¼ë°˜ìš©ë„</span>
          </div>
          <p class="text-sm text-blue-800"><strong>Chart.js</strong> - ê°„ë‹¨í•˜ê³  ì§ê´€ì </p>
          <p class="text-xs text-blue-700 mt-1">âœ… Canvas ê¸°ë°˜, ë¹ ë¥¸ ë Œë”ë§, ë°˜ì‘í˜•</p>
        </div>

        <div class="border border-gray-200 rounded-lg p-4 bg-green-50">
          <div class="flex items-center justify-between mb-2">
            <h4 class="font-semibold text-green-900">âš¡ ê³ ì„±ëŠ¥</h4>
            <span class="text-xs bg-green-100 text-green-800 px-2 py-1 rounded">ëŒ€ìš©ëŸ‰</span>
          </div>
          <p class="text-sm text-green-800"><strong>ECharts</strong> - ë¹ ë¥¸ ëŒ€ìš©ëŸ‰ ì²˜ë¦¬</p>
          <p class="text-xs text-green-700 mt-1">âœ… ì§€ë„ ì°¨íŠ¸, ëŒ€ìš©ëŸ‰ ë°ì´í„°, ê³ ì„±ëŠ¥</p>
        </div>

        <div class="border border-gray-200 rounded-lg p-4 bg-purple-50">
          <div class="flex items-center justify-between mb-2">
            <h4 class="font-semibold text-purple-900">ğŸ¨ í˜„ëŒ€ì </h4>
            <span class="text-xs bg-purple-100 text-purple-800 px-2 py-1 rounded">ì¸í„°ë™í‹°ë¸Œ</span>
          </div>
          <p class="text-sm text-purple-800"><strong>ApexCharts</strong> - ëª¨ë˜ ì• ë‹ˆë©”ì´ì…˜</p>
          <p class="text-xs text-purple-700 mt-1">âœ… ì¤Œ/íŒ¬, ì•„ë¦„ë‹¤ìš´ UI, ëª¨ë°”ì¼ ì¹œí™”ì </p>
        </div>
      </div>

      <!-- Detailed Comparison (Hidden by default) -->
      <div id="detailed-chart-comparison" style="display: none;" class="space-y-6">
        <!-- Library Comparison Table -->
        <div>
          <h4 class="text-lg font-semibold text-gray-800 mb-4 flex items-center">
            ğŸ”§ ë¼ì´ë¸ŒëŸ¬ë¦¬ë³„ íŠ¹ì„± ë¹„êµ
            <button 
              class="ml-2 text-gray-400 hover:text-gray-600 cursor-help"
              onclick="toggleLicenseTooltip()"
              title="ë¼ì´ì„¼ìŠ¤ ì •ë³´ ë³´ê¸°"
            >
              <i class="fas fa-info-circle"></i>
            </button>
          </h4>
          
          <!-- ë¼ì´ì„¼ìŠ¤ ì •ë³´ íˆ´íŒ -->
          <div id="license-tooltip" class="hidden mb-4 p-4 bg-blue-50 border-l-4 border-blue-400 rounded">
            <h5 class="font-semibold text-blue-800 mb-2">ğŸ“„ ë¼ì´ì„¼ìŠ¤ ì¢…ë¥˜ ì„¤ëª…</h5>
            <div class="text-sm text-blue-700 space-y-2">
              <div><strong>MIT:</strong> ìƒì—…ì  ì´ìš© ê°€ëŠ¥, ìˆ˜ì •/ë°°í¬ ììœ , ë¼ì´ì„¼ìŠ¤ ê³ ì§€ ì˜ë¬´</div>
              <div><strong>Apache 2.0:</strong> MITì™€ ìœ ì‚¬í•˜ë‚˜ íŠ¹í—ˆê¶Œ ë³´í˜¸, ë³€ê²½ì‚¬í•­ ëª…ì‹œ í•„ìš”</div>
              <div><strong>BSD:</strong> MITì™€ ìœ ì‚¬í•œ ììœ  ë¼ì´ì„¼ìŠ¤, ìƒì—…ì  ì´ìš© ê°€ëŠ¥</div>
              <div><strong>Dual License:</strong> ì˜¤í”ˆì†ŒìŠ¤(ë¬´ë£Œ)ì™€ ìƒì—…ì  ë¼ì´ì„¼ìŠ¤(ìœ ë£Œ) ì¤‘ ì„ íƒ</div>
              <div><strong>Commercial:</strong> ìƒì—…ì  ë¼ì´ì„¼ìŠ¤ í•„ìš”, ê³ ê¸‰ ê¸°ëŠ¥ì€ ìœ ë£Œ í”Œëœ</div>
            </div>
          </div>
          <div class="overflow-x-auto">
            <table class="min-w-full divide-y divide-gray-200">
              <thead class="bg-gray-50">
                <tr>
                  <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">ë¼ì´ë¸ŒëŸ¬ë¦¬</th>
                  <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">ì¥ì </th>
                  <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">ë‹¨ì </th>
                  <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">ì í•©í•œ ìš©ë„</th>
                  <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">ë²ˆë“¤í¬ê¸°</th>
                  <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">í•™ìŠµë‚œì´ë„</th>
                  <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">ë¼ì´ì„¼ìŠ¤</th>
                </tr>
              </thead>
              <tbody class="bg-white divide-y divide-gray-200">
                <!-- Chart.js -->
                <tr class="hover:bg-gray-50">
                  <td class="px-4 py-4 whitespace-nowrap">
                    <div class="flex items-center">
                      <div class="w-3 h-3 bg-blue-500 rounded-full mr-2"></div>
                      <div>
                        <div class="text-sm font-medium text-gray-900">Chart.js</div>
                        <div class="text-xs text-gray-500">Canvas ê¸°ë°˜</div>
                      </div>
                    </div>
                  </td>
                  <td class="px-4 py-4 text-sm text-gray-900">
                    <ul class="text-xs space-y-1">
                      <li>âœ… ê°„ë‹¨í•œ APIì™€ ì‚¬ìš©ë²•</li>
                      <li>âœ… ë›°ì–´ë‚œ ì„±ëŠ¥ (Canvas)</li>
                      <li>âœ… ì™„ë²½í•œ ë°˜ì‘í˜• ì§€ì›</li>
                      <li>âœ… ê´‘ë²”ìœ„í•œ ì»¤ë®¤ë‹ˆí‹°</li>
                    </ul>
                  </td>
                  <td class="px-4 py-4 text-sm text-gray-900">
                    <ul class="text-xs space-y-1">
                      <li>âŒ ì œí•œì ì¸ ìƒí˜¸ì‘ìš©</li>
                      <li>âŒ ë³µì¡í•œ ì°¨íŠ¸ êµ¬í˜„ ì–´ë ¤ì›€</li>
                      <li>âŒ 3D ì°¨íŠ¸ ë¯¸ì§€ì›</li>
                    </ul>
                  </td>
                  <td class="px-4 py-4 text-sm text-gray-900">
                    <span class="inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-blue-100 text-blue-800">
                      ê¸°ë³¸ ëŒ€ì‹œë³´ë“œ
                    </span>
                  </td>
                  <td class="px-4 py-4 whitespace-nowrap">
                    <div class="flex items-center">
                      <div class="w-16 bg-gray-200 rounded-full h-2 mr-2">
                        <div class="bg-green-500 h-2 rounded-full" style="width: 70%"></div>
                      </div>
                      <span class="text-xs text-gray-600">60KB</span>
                    </div>
                  </td>
                  <td class="px-4 py-4 whitespace-nowrap">
                    <span class="inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-green-100 text-green-800">
                      ì‰¬ì›€
                    </span>
                  </td>
                  <td class="px-4 py-4 whitespace-nowrap">
                    <div class="text-xs">
                      <span class="inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-green-100 text-green-800 mb-1">
                        MIT
                      </span>
                      <div class="text-gray-600">ì™„ì „ ë¬´ë£Œ</div>
                    </div>
                  </td>
                </tr>

                <!-- ApexCharts -->
                <tr class="hover:bg-gray-50">
                  <td class="px-4 py-4 whitespace-nowrap">
                    <div class="flex items-center">
                      <div class="w-3 h-3 bg-green-500 rounded-full mr-2"></div>
                      <div>
                        <div class="text-sm font-medium text-gray-900">ApexCharts</div>
                        <div class="text-xs text-gray-500">SVG ê¸°ë°˜</div>
                      </div>
                    </div>
                  </td>
                  <td class="px-4 py-4 text-sm text-gray-900">
                    <ul class="text-xs space-y-1">
                      <li>âœ… ì•„ë¦„ë‹¤ìš´ ì• ë‹ˆë©”ì´ì…˜</li>
                      <li>âœ… ë‹¤ì–‘í•œ ì°¨íŠ¸ íƒ€ì…</li>
                      <li>âœ… ë‚´ì¥ ì¤Œ/íŒ¬ ê¸°ëŠ¥</li>
                      <li>âœ… ëª¨ë°”ì¼ ì¹œí™”ì </li>
                    </ul>
                  </td>
                  <td class="px-4 py-4 text-sm text-gray-900">
                    <ul class="text-xs space-y-1">
                      <li>âŒ ìƒëŒ€ì ìœ¼ë¡œ í° ìš©ëŸ‰</li>
                      <li>âŒ ì»¤ìŠ¤í„°ë§ˆì´ì§• ì œì•½</li>
                      <li>âŒ ê³ ê¸‰ ê¸°ëŠ¥ì€ ìœ ë£Œ</li>
                    </ul>
                  </td>
                  <td class="px-4 py-4 text-sm text-gray-900">
                    <span class="inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-green-100 text-green-800">
                      ë¹„ì¦ˆë‹ˆìŠ¤ ëŒ€ì‹œë³´ë“œ
                    </span>
                  </td>
                  <td class="px-4 py-4 whitespace-nowrap">
                    <div class="flex items-center">
                      <div class="w-16 bg-gray-200 rounded-full h-2 mr-2">
                        <div class="bg-yellow-500 h-2 rounded-full" style="width: 80%"></div>
                      </div>
                      <span class="text-xs text-gray-600">80KB</span>
                    </div>
                  </td>
                  <td class="px-4 py-4 whitespace-nowrap">
                    <span class="inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-green-100 text-green-800">
                      ì‰¬ì›€
                    </span>
                  </td>
                  <td class="px-4 py-4 whitespace-nowrap">
                    <div class="text-xs">
                      <span class="inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-orange-100 text-orange-800 mb-1">
                        MIT/Commercial
                      </span>
                      <div class="text-gray-600">ë¬´ë£Œ/í”„ë¦¬ë¯¸ì—„</div>
                    </div>
                  </td>
                </tr>

                <!-- D3.js -->
                <tr class="hover:bg-gray-50">
                  <td class="px-4 py-4 whitespace-nowrap">
                    <div class="flex items-center">
                      <div class="w-3 h-3 bg-yellow-500 rounded-full mr-2"></div>
                      <div>
                        <div class="text-sm font-medium text-gray-900">D3.js</div>
                        <div class="text-xs text-gray-500">SVG ê¸°ë°˜</div>
                      </div>
                    </div>
                  </td>
                  <td class="px-4 py-4 text-sm text-gray-900">
                    <ul class="text-xs space-y-1">
                      <li>âœ… ë¬´í•œí•œ ì»¤ìŠ¤í„°ë§ˆì´ì§•</li>
                      <li>âœ… ê°•ë ¥í•œ ë°ì´í„° ì¡°ì‘</li>
                      <li>âœ… ìœ ë‹ˆí¬í•œ ì‹œê°í™” ê°€ëŠ¥</li>
                      <li>âœ… ì‘ì€ ì½”ì–´ ì‚¬ì´ì¦ˆ</li>
                    </ul>
                  </td>
                  <td class="px-4 py-4 text-sm text-gray-900">
                    <ul class="text-xs space-y-1">
                      <li>âŒ ë§¤ìš° ë†’ì€ í•™ìŠµ ê³¡ì„ </li>
                      <li>âŒ ê°œë°œ ì‹œê°„ ë§ì´ ì†Œìš”</li>
                      <li>âŒ ë³µì¡í•œ ì½”ë“œ êµ¬ì¡°</li>
                    </ul>
                  </td>
                  <td class="px-4 py-4 text-sm text-gray-900">
                    <span class="inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-yellow-100 text-yellow-800">
                      ë§ì¶¤í˜• ì‹œê°í™”
                    </span>
                  </td>
                  <td class="px-4 py-4 whitespace-nowrap">
                    <div class="flex items-center">
                      <div class="w-16 bg-gray-200 rounded-full h-2 mr-2">
                        <div class="bg-green-500 h-2 rounded-full" style="width: 30%"></div>
                      </div>
                      <span class="text-xs text-gray-600">30KB</span>
                    </div>
                  </td>
                  <td class="px-4 py-4 whitespace-nowrap">
                    <span class="inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-red-100 text-red-800">
                      ì–´ë ¤ì›€
                    </span>
                  </td>
                  <td class="px-4 py-4 whitespace-nowrap">
                    <div class="text-xs">
                      <span class="inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-green-100 text-green-800 mb-1">
                        BSD
                      </span>
                      <div class="text-gray-600">ì™„ì „ ë¬´ë£Œ</div>
                    </div>
                  </td>
                </tr>

                <!-- Plotly.js -->
                <tr class="hover:bg-gray-50">
                  <td class="px-4 py-4 whitespace-nowrap">
                    <div class="flex items-center">
                      <div class="w-3 h-3 bg-purple-500 rounded-full mr-2"></div>
                      <div>
                        <div class="text-sm font-medium text-gray-900">Plotly.js</div>
                        <div class="text-xs text-gray-500">WebGL ì§€ì›</div>
                      </div>
                    </div>
                  </td>
                  <td class="px-4 py-4 text-sm text-gray-900">
                    <ul class="text-xs space-y-1">
                      <li>âœ… ê³¼í•™ì  ì°¨íŠ¸ íŠ¹í™”</li>
                      <li>âœ… 3D ì°¨íŠ¸ ì§€ì›</li>
                      <li>âœ… í†µê³„ ë¶„ì„ ê¸°ëŠ¥</li>
                      <li>âœ… WebGL ê°€ì†</li>
                    </ul>
                  </td>
                  <td class="px-4 py-4 text-sm text-gray-900">
                    <ul class="text-xs space-y-1">
                      <li>âŒ ë§¤ìš° í° ë²ˆë“¤ ì‚¬ì´ì¦ˆ</li>
                      <li>âŒ ëŠë¦° ì´ˆê¸° ë¡œë”©</li>
                      <li>âŒ ë³µì¡í•œ ì„¤ì •</li>
                    </ul>
                  </td>
                  <td class="px-4 py-4 text-sm text-gray-900">
                    <span class="inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-purple-100 text-purple-800">
                      ê³¼í•™/ì—°êµ¬ìš©
                    </span>
                  </td>
                  <td class="px-4 py-4 whitespace-nowrap">
                    <div class="flex items-center">
                      <div class="w-16 bg-gray-200 rounded-full h-2 mr-2">
                        <div class="bg-red-500 h-2 rounded-full" style="width: 100%"></div>
                      </div>
                      <span class="text-xs text-gray-600">300KB</span>
                    </div>
                  </td>
                  <td class="px-4 py-4 whitespace-nowrap">
                    <span class="inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-yellow-100 text-yellow-800">
                      ë³´í†µ
                    </span>
                  </td>
                  <td class="px-4 py-4 whitespace-nowrap">
                    <div class="text-xs">
                      <span class="inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-orange-100 text-orange-800 mb-1">
                        MIT/Commercial
                      </span>
                      <div class="text-gray-600">ë¬´ë£Œ/ì—”í„°í”„ë¼ì´ì¦ˆ</div>
                    </div>
                  </td>
                </tr>

                <!-- ECharts -->
                <tr class="hover:bg-gray-50">
                  <td class="px-4 py-4 whitespace-nowrap">
                    <div class="flex items-center">
                      <div class="w-3 h-3 bg-red-500 rounded-full mr-2"></div>
                      <div>
                        <div class="text-sm font-medium text-gray-900">ECharts</div>
                        <div class="text-xs text-gray-500">Canvas/SVG</div>
                      </div>
                    </div>
                  </td>
                  <td class="px-4 py-4 text-sm text-gray-900">
                    <ul class="text-xs space-y-1">
                      <li>âœ… ë›°ì–´ë‚œ ì„±ëŠ¥</li>
                      <li>âœ… ì§€ë„ ì°¨íŠ¸ ì§€ì›</li>
                      <li>âœ… ëŒ€ìš©ëŸ‰ ë°ì´í„° ì²˜ë¦¬</li>
                      <li>âœ… ë‹¤ì–‘í•œ í…Œë§ˆ</li>
                    </ul>
                  </td>
                  <td class="px-4 py-4 text-sm text-gray-900">
                    <ul class="text-xs space-y-1">
                      <li>âŒ ì¤‘êµ­ì–´ ì¤‘ì‹¬ ë¬¸ì„œ</li>
                      <li>âŒ í° ë¼ì´ë¸ŒëŸ¬ë¦¬ í¬ê¸°</li>
                      <li>âŒ í•œêµ­ì–´ ìë£Œ ë¶€ì¡±</li>
                    </ul>
                  </td>
                  <td class="px-4 py-4 text-sm text-gray-900">
                    <span class="inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-red-100 text-red-800">
                      ëŒ€ìš©ëŸ‰ ë°ì´í„°
                    </span>
                  </td>
                  <td class="px-4 py-4 whitespace-nowrap">
                    <div class="flex items-center">
                      <div class="w-16 bg-gray-200 rounded-full h-2 mr-2">
                        <div class="bg-red-500 h-2 rounded-full" style="width: 95%"></div>
                      </div>
                      <span class="text-xs text-gray-600">400KB</span>
                    </div>
                  </td>
                  <td class="px-4 py-4 whitespace-nowrap">
                    <span class="inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-yellow-100 text-yellow-800">
                      ë³´í†µ
                    </span>
                  </td>
                  <td class="px-4 py-4 whitespace-nowrap">
                    <div class="text-xs">
                      <span class="inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-green-100 text-green-800 mb-1">
                        Apache 2.0
                      </span>
                      <div class="text-gray-600">ì™„ì „ ë¬´ë£Œ</div>
                    </div>
                  </td>
                </tr>
              </tbody>
            </table>
          </div>
        </div>

        <!-- Chart Types Guide -->
        <div>
          <h4 class="text-lg font-semibold text-gray-800 mb-4">ğŸ“ˆ ì°¨íŠ¸ íƒ€ì…ë³„ í™œìš© ê°€ì´ë“œ</h4>
          <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4">
            
            <div class="bg-blue-50 border border-blue-200 rounded-lg p-4">
              <div class="flex items-center mb-2">
                <div class="w-4 h-4 bg-blue-500 rounded-full mr-2"></div>
                <h5 class="font-medium text-blue-900">ë¼ì¸ ì°¨íŠ¸</h5>
              </div>
              <p class="text-sm text-blue-700 mb-2">ì‹œê°„ë³„ ë³€í™” ì¶”ì´</p>
              <div class="text-xs text-blue-600">
                <div class="mb-1"><strong>ì í•©:</strong> ë§¤ì¶œ ì¶”ì´, ë°©ë¬¸ì ë³€í™”</div>
                <div class="mb-1"><strong>ì¥ì :</strong> íŠ¸ë Œë“œ íŒŒì•… ìš©ì´</div>
                <div><strong>ê¶Œì¥:</strong> Chart.js, ApexCharts</div>
              </div>
            </div>

            <div class="bg-green-50 border border-green-200 rounded-lg p-4">
              <div class="flex items-center mb-2">
                <div class="w-4 h-4 bg-green-500 rounded-full mr-2"></div>
                <h5 class="font-medium text-green-900">ë°” ì°¨íŠ¸</h5>
              </div>
              <p class="text-sm text-green-700 mb-2">ì¹´í…Œê³ ë¦¬ë³„ ë¹„êµ</p>
              <div class="text-xs text-green-600">
                <div class="mb-1"><strong>ì í•©:</strong> ì§€ì—­ë³„ ë§¤ì¶œ, ì œí’ˆë³„ íŒë§¤</div>
                <div class="mb-1"><strong>ì¥ì :</strong> ì§ê´€ì  ë¹„êµ</div>
                <div><strong>ê¶Œì¥:</strong> ApexCharts, ECharts</div>
              </div>
            </div>

            <div class="bg-yellow-50 border border-yellow-200 rounded-lg p-4">
              <div class="flex items-center mb-2">
                <div class="w-4 h-4 bg-yellow-500 rounded-full mr-2"></div>
                <h5 class="font-medium text-yellow-900">íŒŒì´ ì°¨íŠ¸</h5>
              </div>
              <p class="text-sm text-yellow-700 mb-2">ì „ì²´ ëŒ€ë¹„ ë¹„ìœ¨</p>
              <div class="text-xs text-yellow-600">
                <div class="mb-1"><strong>ì í•©:</strong> ì‹œì¥ ì ìœ ìœ¨, ì˜ˆì‚° ë°°ë¶„</div>
                <div class="mb-1"><strong>ì¥ì :</strong> ë¹„ìœ¨ ì´í•´ ì‰¬ì›€</div>
                <div><strong>ê¶Œì¥:</strong> Chart.js, ECharts</div>
              </div>
            </div>

            <div class="bg-purple-50 border border-purple-200 rounded-lg p-4">
              <div class="flex items-center mb-2">
                <div class="w-4 h-4 bg-purple-500 rounded-full mr-2"></div>
                <h5 class="font-medium text-purple-900">ì˜ì—­ ì°¨íŠ¸</h5>
              </div>
              <p class="text-sm text-purple-700 mb-2">ëˆ„ì  ë°ì´í„° ë³€í™”</p>
              <div class="text-xs text-purple-600">
                <div class="mb-1"><strong>ì í•©:</strong> ëˆ„ì  ë§¤ì¶œ, ë‹¤ì¤‘ ì§€í‘œ</div>
                <div class="mb-1"><strong>ì¥ì :</strong> ì „ì²´ëŸ‰ê³¼ êµ¬ì„± ë™ì‹œ</div>
                <div><strong>ê¶Œì¥:</strong> D3.js, ApexCharts</div>
              </div>
            </div>

            <div class="bg-red-50 border border-red-200 rounded-lg p-4">
              <div class="flex items-center mb-2">
                <div class="w-4 h-4 bg-red-500 rounded-full mr-2"></div>
                <h5 class="font-medium text-red-900">ë²„ë¸” ì°¨íŠ¸</h5>
              </div>
              <p class="text-sm text-red-700 mb-2">3ì°¨ì› ë°ì´í„°</p>
              <div class="text-xs text-red-600">
                <div class="mb-1"><strong>ì í•©:</strong> ë§¤ì¶œ-ì´ìµ-ì ìœ ìœ¨</div>
                <div class="mb-1"><strong>ì¥ì :</strong> ë‹¤ì°¨ì› ë¶„ì„</div>
                <div><strong>ê¶Œì¥:</strong> Plotly.js, D3.js</div>
              </div>
            </div>

            <div class="bg-indigo-50 border border-indigo-200 rounded-lg p-4">
              <div class="flex items-center mb-2">
                <div class="w-4 h-4 bg-indigo-500 rounded-full mr-2"></div>
                <h5 class="font-medium text-indigo-900">ë ˆì´ë” ì°¨íŠ¸</h5>
              </div>
              <p class="text-sm text-indigo-700 mb-2">ë‹¤ë©´ì  ì„±ê³¼ ì§€í‘œ</p>
              <div class="text-xs text-indigo-600">
                <div class="mb-1"><strong>ì í•©:</strong> ì—­ëŸ‰ í‰ê°€, ì œí’ˆ ë¹„êµ</div>
                <div class="mb-1"><strong>ì¥ì :</strong> ê· í˜•ìˆëŠ” ë¶„ì„</div>
                <div><strong>ê¶Œì¥:</strong> Chart.js, ApexCharts</div>
              </div>
            </div>

            <div class="bg-pink-50 border border-pink-200 rounded-lg p-4">
              <div class="flex items-center mb-2">
                <div class="w-4 h-4 bg-pink-500 rounded-full mr-2"></div>
                <h5 class="font-medium text-pink-900">ê²Œì´ì§€ ì°¨íŠ¸</h5>
              </div>
              <p class="text-sm text-pink-700 mb-2">ëª©í‘œ ë‹¬ì„±ë¥ </p>
              <div class="text-xs text-pink-600">
                <div class="mb-1"><strong>ì í•©:</strong> KPI ë‹¬ì„±ë¥ , ì§„í–‰ë¥ </div>
                <div class="mb-1"><strong>ì¥ì :</strong> ì§ê´€ì  ìƒíƒœ í‘œì‹œ</div>
                <div><strong>ê¶Œì¥:</strong> ApexCharts, ECharts</div>
              </div>
            </div>

            <div class="bg-teal-50 border border-teal-200 rounded-lg p-4">
              <div class="flex items-center mb-2">
                <div class="w-4 h-4 bg-teal-500 rounded-full mr-2"></div>
                <h5 class="font-medium text-teal-900">í¼ë„ ì°¨íŠ¸</h5>
              </div>
              <p class="text-sm text-teal-700 mb-2">ì „í™˜ ê³¼ì • ë¶„ì„</p>
              <div class="text-xs text-teal-600">
                <div class="mb-1"><strong>ì í•©:</strong> íŒë§¤ ë‹¨ê³„, ì‚¬ìš©ì íë¦„</div>
                <div class="mb-1"><strong>ì¥ì :</strong> ë‹¨ê³„ë³„ ì†ì‹¤ íŒŒì•…</div>
                <div><strong>ê¶Œì¥:</strong> ECharts, Plotly.js</div>
              </div>
            </div>
          </div>
        </div>

        <!-- Usage Recommendations -->
        <div class="p-4 bg-gray-50 rounded-lg">
          <h4 class="font-semibold text-gray-900 mb-3">ğŸ’¡ í”„ë¡œì íŠ¸ë³„ ì¶”ì²œ</h4>
          <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
            <div class="bg-white p-3 rounded border-l-4 border-blue-500">
              <h5 class="font-medium text-blue-900">ğŸ“ˆ ê¸°ë³¸ ëŒ€ì‹œë³´ë“œ</h5>
              <p class="text-sm text-gray-700">Chart.js (ì•ˆì •ì„±) ë˜ëŠ” ApexCharts (UI)</p>
            </div>
            <div class="bg-white p-3 rounded border-l-4 border-green-500">
              <h5 class="font-medium text-green-900">ğŸ“Š ë¹„ì¦ˆë‹ˆìŠ¤ ì¸í…”ë¦¬ì „ìŠ¤</h5>
              <p class="text-sm text-gray-700">ECharts (ì„±ëŠ¥) ë˜ëŠ” Plotly.js (ë¶„ì„)</p>
            </div>
            <div class="bg-white p-3 rounded border-l-4 border-purple-500">
              <h5 class="font-medium text-purple-900">ğŸ¨ ë§ì¶¤í˜• ì‹œê°í™”</h5>
              <p class="text-sm text-gray-700">D3.js (ë¬´í•œ ì»¤ìŠ¤í„°ë§ˆì´ì§•)</p>
            </div>
            <div class="bg-white p-3 rounded border-l-4 border-orange-500">
              <h5 class="font-medium text-orange-900">ğŸ“± ëª¨ë°”ì¼ ìš°ì„ </h5>
              <p class="text-sm text-gray-700">ApexCharts (ë°˜ì‘í˜•) ë˜ëŠ” Chart.js</p>
            </div>
            <div class="bg-white p-3 rounded border-l-4 border-red-500">
              <h5 class="font-medium text-red-900">ğŸŒ ì§€ë¦¬ ì •ë³´</h5>
              <p class="text-sm text-gray-700">ECharts (ì§€ë„) ë˜ëŠ” D3.js</p>
            </div>
            <div class="bg-white p-3 rounded border-l-4 border-teal-500">
              <h5 class="font-medium text-teal-900">ğŸ”¬ ê³¼í•™/ì—°êµ¬</h5>
              <p class="text-sm text-gray-700">Plotly.js (3D, í†µê³„)</p>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
 
 

</div>

{{!-- ëŒ€ì‹œë³´ë“œ JavaScript --}}
<script>
/**
 * ëª¨ë˜ ëŒ€ì‹œë³´ë“œ ì´ˆê¸°í™”
 * ì»´í¬ë„ŒíŠ¸ ê¸°ë°˜ ì•„í‚¤í…ì²˜ë¡œ êµ¬ì„±
 */

class ModernDashboard {
  constructor() {
    this.isInitialized = false;
    this.isInitializing = false;
    this.components = {
      dataProvider: null,
      chartManager: null
    };
    
    this.init();
  }

  async init() {
    // ëŒ€ì‹œë³´ë“œ í˜ì´ì§€ì¸ì§€ í™•ì¸
    if (!this.isDashboardPage()) {
      console.log('âŒ Not dashboard page - skipping initialization');
      return;
    }

    // ì´ë¯¸ ì´ˆê¸°í™” ì¤‘ì´ë©´ ì¤‘ë³µ ì‹¤í–‰ ë°©ì§€
    if (this.isInitializing) {
      console.log('â³ Dashboard initialization already in progress');
      return;
    }

    this.isInitializing = true;
    console.log('ğŸš€ Modern Dashboard initializing...');

    try {
      // ì„ì‹œë¡œ ì»´í¬ë„ŒíŠ¸ ëŒ€ê¸°ë¥¼ ìƒëµí•˜ê³  ë°”ë¡œ ì§„í–‰
      console.log('ğŸ”§ Skipping component wait for debugging...');
      
      // ì»´í¬ë„ŒíŠ¸ê°€ ìˆìœ¼ë©´ ì‚¬ìš©, ì—†ìœ¼ë©´ ëª©ì—…ìœ¼ë¡œ ì§„í–‰
      this.components.dataProvider = window.DataProvider || this.createMockDataProvider();
      this.components.chartManager = window.ChartManager || this.createMockChartManager();

      console.log('ğŸ“Š Components ready:', {
        dataProvider: !!this.components.dataProvider,
        chartManager: !!this.components.chartManager
      });

      // ì´ˆê¸° ë°ì´í„° ë¡œë“œ
      await this.loadInitialData();

      // ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ì„¤ì • (ì¤‘ë³µ ë°©ì§€)
      if (!this.isInitialized) {
        this.setupEventListeners();
      }

      // ì‹¤ì‹œê°„ ì—…ë°ì´íŠ¸ ì‹œì‘
      this.startRealTimeUpdates();

      this.isInitialized = true;
      this.isInitializing = false;
      console.log('âœ… Modern Dashboard initialized successfully');

    } catch (error) {
      this.isInitializing = false;
      console.error('âŒ Dashboard initialization failed:', error);
      console.error('Error stack:', error.stack);
      console.error('Components status:', {
        DataProvider: !!window.DataProvider,
        ChartManager: !!window.ChartManager,
        dashboardContainer: !!document.getElementById('dashboard-container')
      });
      this.showErrorState();
    }
  }

  isDashboardPage() {
    return window.location.pathname === '/dashboard' && 
           document.getElementById('dashboard-container');
  }

  createMockDataProvider() {
    return {
      getStats: async () => ({
        totalInquiries: { title: 'ì´ ë¬¸ì˜', value: '1,247', change: '+3%', isPositive: true, changeLabel: 'ì „ì£¼ ëŒ€ë¹„' },
        pendingInquiries: { title: 'ëŒ€ê¸° ì¤‘', value: '3', change: '-2', isPositive: false, changeLabel: 'ì–´ì œ ëŒ€ë¹„' },
        completedInquiries: { title: 'ì™„ë£Œ', value: '1,172', change: '+5%', isPositive: true, changeLabel: 'ì „ì£¼ ëŒ€ë¹„' },
        totalUsers: { title: 'ì‚¬ìš©ì', value: '156', change: '+2', isPositive: true, changeLabel: 'ì–´ì œ ëŒ€ë¹„' }
      }),
      getChartData: async (type) => {
        const mockData = {
          line: { labels: ['Jan', 'Feb', 'Mar', 'Apr'], datasets: [{ label: 'Mock', data: [12, 19, 3, 5], borderColor: '#3b82f6' }] },
          bar: { labels: ['A', 'B', 'C'], datasets: [{ label: 'Mock', data: [12, 19, 3], backgroundColor: '#10b981' }] },
          pie: { labels: ['ì™„ë£Œ', 'ëŒ€ê¸°', 'ì§„í–‰'], datasets: [{ data: [300, 50, 100], backgroundColor: ['#3b82f6', '#f59e0b', '#ef4444'] }] }
        };
        return mockData[type] || mockData.line;
      },
      startRealTimeUpdates: (callback, interval) => setInterval(() => callback({}), interval)
    };
  }

  createMockChartManager() {
    return {
      createChart: (id, type, data, options, library) => {
        console.log(`ğŸ“ˆ Mock chart created: ${id} (${type}, ${library})`);
        const container = document.getElementById(id);
        if (container) {
          container.innerHTML = `<div class="flex items-center justify-center h-full bg-gray-100 rounded">
            <div class="text-center">
              <div class="text-2xl mb-2">ğŸ“Š</div>
              <div class="text-sm text-gray-600">Mock Chart (${type})</div>
            </div>
          </div>`;
        }
      },
      destroyAll: () => console.log('ğŸ§¹ Mock charts destroyed')
    };
  }

  async waitForComponents() {
    const maxAttempts = 100; // 10ì´ˆ ëŒ€ê¸°
    let attempts = 0;

    console.log('â³ Waiting for components to load...');
    
    while (attempts < maxAttempts) {
      const hasDataProvider = !!window.DataProvider;
      const hasChartManager = !!window.ChartManager;
      const hasChart = !!window.Chart;
      const hasApexCharts = !!window.ApexCharts;
      const hasD3 = !!window.d3;
      const hasPlotly = !!window.Plotly;
      const hasEcharts = !!window.echarts;
      
      if (attempts % 10 === 0) {
        console.log(`Attempt ${attempts + 1}:`, {
          DataProvider: hasDataProvider,
          ChartManager: hasChartManager,
          Chart: hasChart,
          ApexCharts: hasApexCharts,
          d3: hasD3,
          Plotly: hasPlotly,
          echarts: hasEcharts
        });
      }
      
      if (hasDataProvider && hasChartManager && hasChart) {
        console.log('âœ… All required components loaded');
        return;
      }
      
      await new Promise(resolve => setTimeout(resolve, 100));
      attempts++;
    }

    console.error('âŒ Component loading timeout:', {
      DataProvider: !!window.DataProvider,
      ChartManager: !!window.ChartManager,
      Chart: !!window.Chart,
      ApexCharts: !!window.ApexCharts,
      d3: !!window.d3,
      Plotly: !!window.Plotly,
      echarts: !!window.echarts,
      attempts: attempts
    });
    throw new Error('Required components not loaded after 10 seconds');
  }

  async loadInitialData() {
    console.log('ğŸ“Š Loading initial dashboard data...');

    console.log('1ï¸âƒ£ Loading stats...');
    await this.loadStats();
    console.log('âœ… Stats loaded');
    
    console.log('2ï¸âƒ£ Loading charts...');
    await this.loadCharts();
    console.log('âœ… Charts loaded');
    
    console.log('3ï¸âƒ£ Loading additional data...');
    await this.loadAdditionalData();
    console.log('âœ… Additional data loaded');
    
    console.log('ğŸ‰ All initial data loaded successfully');
  }

  async loadStats() {
    const stats = await this.components.dataProvider.getStats();
    this.renderStats(stats);
  }

  async loadCharts() {
    const chartConfigs = [
      { id: 'trend-chart', type: 'line', dataType: 'line', library: 'chartjs' },
      { id: 'daily-chart', type: 'bar', dataType: 'bar', library: 'chartjs' },
      { id: 'status-chart', type: 'pie', dataType: 'pie', library: 'chartjs' },
      { id: 'hourly-chart', type: 'area', dataType: 'area', library: 'chartjs' },
      { id: 'bubble-chart', type: 'bubble', dataType: 'bubble', library: 'chartjs' },
      { id: 'radar-chart', type: 'radar', dataType: 'radar', library: 'chartjs' },
      { id: 'gauge-chart', type: 'gauge', dataType: 'gauge', library: 'chartjs' },
      { id: 'funnel-chart', type: 'funnel', dataType: 'funnel', library: 'chartjs' }
    ];

    console.log('ğŸ“Š Loading charts with configs:', chartConfigs);
    
    // ì°¨íŠ¸ ìƒì„± ì‹œ ì•½ê°„ì˜ ì§€ì—°ì„ ì¶”ê°€í•˜ì—¬ DOMì´ ì™„ì „íˆ ì¤€ë¹„ë˜ë„ë¡ í•¨
    await new Promise(resolve => setTimeout(resolve, 100));

    // ëª¨ë“  ì°¨íŠ¸ ì»¨í…Œì´ë„ˆ í™•ì¸
    console.log('ğŸ” Checking chart containers:');
    chartConfigs.forEach(config => {
      const container = document.getElementById(config.id);
      console.log(`- ${config.id}: ${container ? 'âœ… Found' : 'âŒ Not found'}`);
    });

    for (const config of chartConfigs) {
      try {
        const container = document.getElementById(config.id);
        if (!container) {
          console.warn(`âŒ Container not found for chart: ${config.id}`);
          continue;
        }
        
        const data = await this.components.dataProvider.getChartData(config.dataType);
        console.log(`ğŸ“ˆ Creating ${config.id} with type: ${config.type}, library: ${config.library}`);
        
        this.components.chartManager.createChart(
          config.id, 
          config.type, 
          data, 
          {}, 
          config.library || 'chartjs' // ëª…ì‹œì ìœ¼ë¡œ ê¸°ë³¸ ë¼ì´ë¸ŒëŸ¬ë¦¬ ì§€ì •
        );
        console.log(`âœ… Chart initialized: ${config.id} with ${config.library}`);
      } catch (error) {
        console.error(`âŒ Failed to load chart ${config.id}:`, error);
      }
    }
    
    console.log('ğŸ‰ All charts loading complete');
    
    // ì°¨íŠ¸ ìƒíƒœ ìµœì¢… í™•ì¸
    setTimeout(() => {
      console.log('ğŸ” Final chart status check:');
      chartConfigs.forEach(config => {
        const container = document.getElementById(config.id);
        if (container) {
          const hasChart = container.querySelector('canvas') || container.querySelector('svg') || container.querySelector('[id*="apex"]') || container.querySelector('[id*="echarts"]') || container.querySelector('[id*="plotly"]');
          console.log(`- ${config.id}: ${hasChart ? 'âœ… Rendered' : 'âŒ Empty'}`);
        }
      });
    }, 2000);
  }

  async loadAdditionalData() {
    // ë¹ ë¥¸ í†µê³„
    this.renderQuickStats();
    
    // ìµœê·¼ í™œë™
    this.renderRecentActivities();
    
    // ë¼ì´ë¸ŒëŸ¬ë¦¬ ë¹„êµëŠ” ì´ë¯¸ HTMLë¡œ êµ¬í˜„ë¨ - JavaScript ë Œë”ë§ ë¶ˆí•„ìš”
    // this.renderLibraryComparison();

    // DOMì´ ì™„ì „íˆ ë¡œë“œëœ í›„ ì§€ì›í•˜ì§€ ì•ŠëŠ” ì˜µì…˜ ìˆ¨ê¸°ê¸°
    setTimeout(() => {
      this.hideUnsupportedLibraryOptions();
    }, 500);
  }

  renderStats(stats) {
    const container = document.getElementById('stats-grid');
    if (!container || !stats) return;

    let html = '';
    for (const [key, stat] of Object.entries(stats)) {
      html += `
        <div class="stat-card">
          ${this.renderStatCard(stat)}
        </div>
      `;
    }

    container.innerHTML = html;
  }

  renderStatCard(stat) {
    const changeIcon = stat.isPositive ? 'fa-arrow-up text-green-500' : 'fa-arrow-down text-red-500';
    const changeColor = stat.isPositive ? 'text-green-600' : 'text-red-600';

    return `
      <div class="bg-white rounded-lg shadow-sm border border-gray-200 p-6 hover:shadow-md transition-shadow duration-200">
        <div class="flex items-center justify-between">
          <div class="flex-1">
            <p class="text-sm font-medium text-gray-600">${stat.title}</p>
            <p class="text-3xl font-bold text-gray-900 mt-2">${stat.value}</p>
            ${stat.change ? `
              <div class="flex items-center mt-2">
                <i class="fas ${changeIcon} text-sm"></i>
                <span class="${changeColor} text-sm font-medium ml-1">${stat.change}</span>
                <span class="text-gray-500 text-sm ml-2">${stat.changeLabel}</span>
              </div>
            ` : ''}
          </div>
          ${stat.icon ? `
            <div class="w-12 h-12 ${stat.iconBg} rounded-lg flex items-center justify-center flex-shrink-0">
              <i class="${stat.icon} ${stat.iconColor} text-xl"></i>
            </div>
          ` : ''}
        </div>
      </div>
    `;
  }

  renderQuickStats() {
    const container = document.getElementById('quick-stats');
    if (!container) return;

    const quickStats = [
      { label: 'ì˜¤ëŠ˜ ì ‘ìˆ˜', value: '12ê±´', icon: 'fas fa-plus-circle', color: 'text-blue-600' },
      { label: 'ì§„í–‰ ì¤‘', value: '5ê±´', icon: 'fas fa-clock', color: 'text-orange-600' },
      { label: 'ì™„ë£Œ', value: '28ê±´', icon: 'fas fa-check-circle', color: 'text-green-600' },
      { label: 'í‰ê·  ë§Œì¡±ë„', value: '4.8/5', icon: 'fas fa-star', color: 'text-yellow-600' }
    ];

    let html = '';
    quickStats.forEach(stat => {
      html += `
        <div class="flex items-center justify-between py-2">
          <div class="flex items-center">
            <i class="${stat.icon} ${stat.color} mr-3"></i>
            <span class="text-sm text-gray-600">${stat.label}</span>
          </div>
          <span class="text-sm font-semibold text-gray-900">${stat.value}</span>
        </div>
      `;
    });

    container.innerHTML = html;
  }

  renderRecentActivities() {
    const container = document.getElementById('recent-activities');
    if (!container) return;

    const activities = [
      { user: 'ê¹€ì˜í¬', action: 'ë¬¸ì˜ì‚¬í•­ ë‹µë³€ ì™„ë£Œ', time: '5ë¶„ ì „', type: 'success' },
      { user: 'ë°•ë¯¼ìˆ˜', action: 'ìƒˆë¡œìš´ ë¬¸ì˜ ì ‘ìˆ˜', time: '15ë¶„ ì „', type: 'info' },
      { user: 'ì´ì² ìˆ˜', action: 'ë¬¸ì˜ì‚¬í•­ ì²˜ë¦¬ ì¤‘', time: '30ë¶„ ì „', type: 'warning' },
      { user: 'ìµœì§€ì€', action: 'ë¬¸ì˜ì‚¬í•­ ë‹µë³€ ì™„ë£Œ', time: '1ì‹œê°„ ì „', type: 'success' }
    ];

    let html = '';
    activities.forEach(activity => {
      const iconMap = {
        success: { icon: 'fas fa-check-circle', color: 'text-green-500' },
        info: { icon: 'fas fa-info-circle', color: 'text-blue-500' },
        warning: { icon: 'fas fa-clock', color: 'text-orange-500' }
      };
      
      const iconInfo = iconMap[activity.type] || iconMap.info;

      html += `
        <div class="flex items-center space-x-3 py-2">
          <i class="${iconInfo.icon} ${iconInfo.color} text-sm flex-shrink-0"></i>
          <div class="flex-1 min-w-0">
            <p class="text-sm text-gray-900">
              <span class="font-medium">${activity.user}</span>ë‹˜ì´ ${activity.action}
            </p>
            <p class="text-xs text-gray-500">${activity.time}</p>
          </div>
        </div>
      `;
    });

    container.innerHTML = html;
  }

  // renderLibraryComparison ë©”ì†Œë“œëŠ” ë” ì´ìƒ í•„ìš”í•˜ì§€ ì•ŠìŒ - HTMLë¡œ ì´ë¯¸ êµ¬í˜„ë¨
  // renderLibraryComparison() { ... }

  setupEventListeners() {
    // ë°ì´í„° ìƒˆë¡œê³ ì¹¨ ì´ë²¤íŠ¸
    document.addEventListener('dataRefreshed', async (event) => {
      console.log('ğŸ”„ Dashboard data refreshed');
      await this.loadInitialData();
    });

    // ì°¨íŠ¸ íƒ€ì… ë³€ê²½ ì´ë²¤íŠ¸ëŠ” ChartManagerì—ì„œ ìë™ ì²˜ë¦¬ë¨

    // ë¸Œë¼ìš°ì € ê°€ì‹œì„± ë³€ê²½ (íƒ­ ì „í™˜ ì‹œ)
    document.addEventListener('visibilitychange', () => {
      if (!document.hidden && this.isInitialized) {
        // íƒ­ì´ ë‹¤ì‹œ í™œì„±í™”ë˜ë©´ ë°ì´í„° ê°±ì‹ 
        setTimeout(() => this.loadStats(), 1000);
      }
    });

    // ì „ì—­ ì´ë²¤íŠ¸ ìœ„ì„ìœ¼ë¡œ ì°¨íŠ¸ ì»¨íŠ¸ë¡¤ ì²˜ë¦¬
    this.setupGlobalChartEventDelegation();
  }

  setupGlobalChartEventDelegation() {
    // ì´ë¯¸ ì„¤ì •ëœ ê²½ìš° ì¤‘ë³µ ë°©ì§€
    if (window._chartEventDelegationSetup) {
      return;
    }
    window._chartEventDelegationSetup = true;

    // ì°¨íŠ¸ ë¼ì´ë¸ŒëŸ¬ë¦¬ ì„ íƒ ì´ë²¤íŠ¸ ìœ„ì„
    document.addEventListener('change', (e) => {
      if (e.target.matches('[data-chart-select]')) {
        const libraryType = e.target.value;
        const chartId = e.target.dataset.chart;
        
        console.log(`ğŸ”„ Switching chart ${chartId} to ${libraryType}`);
        
        // ChartManagerê°€ ìˆìœ¼ë©´ ì§ì ‘ í˜¸ì¶œ, ì—†ìœ¼ë©´ ì´ë²¤íŠ¸ ë°œìƒ
        if (window.ChartManager) {
          window.ChartManager.switchChartType(chartId, libraryType);
        } else {
          // ChartManager ë¡œë”© ì „ì´ë©´ ì´ë²¤íŠ¸ë¡œ ì²˜ë¦¬
          window.dispatchEvent(new CustomEvent('chartTypeChange', {
            detail: { chartId, chartType: libraryType }
          }));
        }
        
        // ì„ íƒëœ ë¼ì´ë¸ŒëŸ¬ë¦¬ì— ë”°ë¼ ìŠ¤íƒ€ì¼ ì—…ë°ì´íŠ¸
        const colors = {
          'chartjs': '#3b82f6',
          'apexcharts': '#10b981', 
          'd3': '#f59e0b',
          'plotly': '#8b5cf6',
          'echarts': '#ef4444'
        };
        
        if (colors[libraryType]) {
          e.target.style.borderColor = colors[libraryType];
        }
      }
    });

    // ìƒˆë¡œê³ ì¹¨ ë²„íŠ¼ ì´ë²¤íŠ¸ ìœ„ì„
    document.addEventListener('click', (e) => {
      if (e.target.matches('[data-chart-refresh]') || e.target.closest('[data-chart-refresh]')) {
        const button = e.target.matches('[data-chart-refresh]') ? e.target : e.target.closest('[data-chart-refresh]');
        const chartId = button.dataset.chartRefresh;
        
        console.log(`ğŸ”„ Refreshing chart ${chartId}`);
        
        // íšŒì „ ì• ë‹ˆë©”ì´ì…˜
        const icon = button.querySelector('i');
        icon.classList.add('fa-spin');
        
        // ì°¨íŠ¸ ìƒˆë¡œê³ ì¹¨ ì´ë²¤íŠ¸
        window.dispatchEvent(new CustomEvent('chartRefresh', {
          detail: { chartId }
        }));
        
        // ì• ë‹ˆë©”ì´ì…˜ ì¢…ë£Œ
        setTimeout(() => {
          icon.classList.remove('fa-spin');
        }, 1000);
      }
    });

    console.log('âœ… Global chart event delegation setup complete');
  }

  hideUnsupportedLibraryOptions() {
    // ë¼ì´ë¸ŒëŸ¬ë¦¬ë³„ ì§€ì›í•˜ì§€ ì•ŠëŠ” ì°¨íŠ¸ íƒ€ì…ë“¤
    const unsupportedCombinations = {
      'd3': ['radar-chart', 'gauge-chart', 'funnel-chart'],
      'apexcharts': ['funnel-chart'],
      'echarts': ['gauge-chart'] // ECharts gauge ì°¨íŠ¸ ì˜¤ë¥˜ë¡œ ë¹„í™œì„±í™”
    };
    
    // ê° ë¼ì´ë¸ŒëŸ¬ë¦¬ë³„ ì§€ì›í•˜ì§€ ì•ŠëŠ” ì°¨íŠ¸ì—ì„œ ì˜µì…˜ ìˆ¨ê¸°ê¸°
    Object.entries(unsupportedCombinations).forEach(([library, chartIds]) => {
      chartIds.forEach(chartId => {
        const select = document.querySelector(`[data-chart-select="${chartId}"]`);
        if (select) {
          const option = select.querySelector(`option[value="${library}"]`);
          if (option) {
            option.style.display = 'none';
            option.disabled = true;
          }
        }
      });
    });
    
    console.log('ğŸ”§ Hidden unsupported library options for specific charts');
  }


  startRealTimeUpdates() {
    // 30ì´ˆë§ˆë‹¤ í†µê³„ ë°ì´í„° ì—…ë°ì´íŠ¸
    this.updateInterval = this.components.dataProvider.startRealTimeUpdates(
      (freshData) => {
        this.renderStats(freshData);
        console.log('ğŸ“Š Real-time data updated');
      },
      30000 // 30ì´ˆ
    );
  }

  showErrorState() {
    const container = document.getElementById('dashboard-container');
    if (container) {
      container.innerHTML = `
        <div class="flex items-center justify-center min-h-96">
          <div class="text-center">
            <i class="fas fa-exclamation-triangle text-red-500 text-4xl mb-4"></i>
            <h3 class="text-lg font-semibold text-gray-900 mb-2">ëŒ€ì‹œë³´ë“œ ë¡œë“œ ì‹¤íŒ¨</h3>
            <p class="text-gray-600 mb-4">ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘ ë¬¸ì œê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.</p>
            <button onclick="window.location.reload()" class="bg-primary-600 text-white px-4 py-2 rounded-lg hover:bg-primary-700">
              í˜ì´ì§€ ìƒˆë¡œê³ ì¹¨
            </button>
          </div>
        </div>
      `;
    }
  }

  destroy() {
    if (this.updateInterval) {
      clearInterval(this.updateInterval);
      this.updateInterval = null;
    }
    
    if (this.components.chartManager) {
      this.components.chartManager.destroyAll();
    }

    this.isInitialized = false;
    this.isInitializing = false;
    this.components.dataProvider = null;
    this.components.chartManager = null;
    
    console.log('ğŸ§¹ Modern Dashboard destroyed');
  }
}

// ëŒ€ì‹œë³´ë“œ ì´ˆê¸°í™”
let dashboardInstance = null;

function initializeDashboard() {
  // ëŒ€ì‹œë³´ë“œ í˜ì´ì§€ê°€ ì•„ë‹ˆë©´ ë¬´ì‹œ
  if (window.location.pathname !== '/dashboard') {
    return;
  }

  // ì´ë¯¸ ì´ˆê¸°í™”ë˜ì–´ ìˆê³  ì°¨íŠ¸ë“¤ì´ ì •ìƒì´ë©´ skip (ë” ì—„ê²©í•œ ê²€ì‚¬)
  if (dashboardInstance && dashboardInstance.isInitialized) {
    const chartContainers = document.querySelectorAll('[data-chart-id]');
    let hasLoadingCharts = false;
    let hasEmptyCharts = false;
    
    chartContainers.forEach(container => {
      const loadingElement = container.querySelector('.fa-spinner');
      const canvas = container.querySelector('canvas');
      
      if (loadingElement) {
        hasLoadingCharts = true;
      }
      
      // ìº”ë²„ìŠ¤ê°€ ì—†ê±°ë‚˜ ì‹¤ì œë¡œ ê·¸ë ¤ì§€ì§€ ì•Šì€ ê²½ìš° ì²´í¬
      if (!canvas || canvas.width === 0 || canvas.height === 0) {
        hasEmptyCharts = true;
        console.log(`ğŸ“Š Empty canvas detected in chart: ${container.getAttribute('data-chart-id')}`);
      }
      
      // Chart.js ì¸ìŠ¤í„´ìŠ¤ê°€ ì‹¤ì œë¡œ ìˆëŠ”ì§€ í™•ì¸
      if (canvas && canvas.chart === undefined && window.Chart) {
        hasEmptyCharts = true;
        console.log(`ğŸ“Š No Chart.js instance found for: ${container.getAttribute('data-chart-id')}`);
      }
    });
    
    // ë¡œë”© ì¤‘ì´ê±°ë‚˜ ë¹ˆ ì°¨íŠ¸ê°€ ìˆìœ¼ë©´ ì¬ì´ˆê¸°í™” í•„ìš”
    if (!hasLoadingCharts && !hasEmptyCharts) {
      console.log('âœ… Dashboard already initialized and ALL charts are properly rendered');
      return;
    } else {
      console.log(`ğŸ”„ Charts need reinitialization - loading: ${hasLoadingCharts}, empty: ${hasEmptyCharts}`);
    }
  }

  // ê¸°ì¡´ ì¸ìŠ¤í„´ìŠ¤ ì •ë¦¬
  if (dashboardInstance) {
    dashboardInstance.destroy();
  }

  // ìƒˆ ì¸ìŠ¤í„´ìŠ¤ ìƒì„±
  dashboardInstance = new ModernDashboard();
}

// DOM ë¡œë“œ ì‹œ ì´ˆê¸°í™” (Turboì™€ ì¤‘ë³µ ë°©ì§€)
document.addEventListener('DOMContentLoaded', () => {
  // Turbo í™˜ê²½ì—ì„œëŠ” turbo:load ì´ë²¤íŠ¸ê°€ ì²˜ë¦¬í•˜ë¯€ë¡œ ìŠ¤í‚µ
  if (!window.Turbo) {
    console.log('ğŸ“„ DOMContentLoaded - Non-Turbo environment');
    setTimeout(initializeDashboard, 1000);
  } else {
    console.log('ğŸ“„ DOMContentLoaded - Turbo environment, skipping (turbo:load will handle)');
  }
});

// ì°¨íŠ¸ ìƒíƒœ ì €ì¥/ë³µì› í•¨ìˆ˜ë“¤
window.saveChartStates = function() {
  const chartStates = {};
  const chartContainers = document.querySelectorAll('[data-chart-id]');
  
  chartContainers.forEach(container => {
    const chartId = container.getAttribute('data-chart-id');
    const select = container.parentElement.querySelector(`[data-chart-select="${chartId}"]`);
    
    if (select) {
      chartStates[chartId] = {
        library: select.value,
        hasCanvas: !!container.querySelector('canvas'),
        timestamp: Date.now()
      };
    }
  });
  
  localStorage.setItem('dashboard-chart-states', JSON.stringify(chartStates));
  console.log('ğŸ’¾ Chart states saved:', chartStates);
};

window.loadChartStates = function() {
  try {
    const saved = localStorage.getItem('dashboard-chart-states');
    if (saved) {
      const chartStates = JSON.parse(saved);
      console.log('ğŸ“‚ Loading saved chart states:', chartStates);
      
      // 5ë¶„ ì´ë‚´ì˜ ìƒíƒœë§Œ ë³µì›
      const now = Date.now();
      Object.keys(chartStates).forEach(chartId => {
        const state = chartStates[chartId];
        if (now - state.timestamp < 300000) { // 5ë¶„
          const select = document.querySelector(`[data-chart-select="${chartId}"]`);
          if (select && select.value !== state.library) {
            console.log(`ğŸ”„ Restoring chart ${chartId} to ${state.library}`);
            select.value = state.library;
            // ì°¨íŠ¸ ë¼ì´ë¸ŒëŸ¬ë¦¬ ë³€ê²½ ì´ë²¤íŠ¸ íŠ¸ë¦¬ê±°
            select.dispatchEvent(new Event('change'));
          }
        }
      });
    }
  } catch (e) {
    console.warn('Chart states loading failed:', e);
  }
};

// ë””ë°”ìš´ì‹±ì„ ìœ„í•œ ë³€ìˆ˜ë“¤
let dashboardReinitTimeout = null;
let dashboardReinitInProgress = false;
let dashboardReinitCount = 0;
let dashboardFirstInitDone = false;

// ê°•ì œ ì°¨íŠ¸ ì¬ì´ˆê¸°í™” í•¨ìˆ˜ (ì¤‘ë³µ ì‹¤í–‰ ë°©ì§€)
window.forceDashboardReinit = function() {
  // ì´ë¯¸ ì§„í–‰ ì¤‘ì´ë©´ ìŠ¤í‚µ
  if (dashboardReinitInProgress) {
    console.log('â­ï¸ Dashboard reinit already in progress, skipping...');
    return;
  }
  
  // ê¸°ì¡´ íƒ€ì„ì•„ì›ƒ í´ë¦¬ì–´
  if (dashboardReinitTimeout) {
    clearTimeout(dashboardReinitTimeout);
    dashboardReinitTimeout = null;
  }
  
  dashboardReinitCount++;
  const currentCount = dashboardReinitCount;
  
  console.log(`ğŸ”§ Force dashboard reinitialization #${currentCount} - scheduling...`);
  
  // 200ms ë””ë°”ìš´ìŠ¤
  dashboardReinitTimeout = setTimeout(() => {
    if (dashboardReinitInProgress) {
      console.log('â­ï¸ Dashboard reinit still in progress, aborting...');
      return;
    }
    
    dashboardReinitInProgress = true;
    console.log(`ğŸš€ Executing dashboard reinitialization #${currentCount}`);
    
    // ì°¨íŠ¸ ìƒíƒœ ì €ì¥
    window.saveChartStates();
    
    // ê¸°ì¡´ ì¸ìŠ¤í„´ìŠ¤ ê°•ì œ ì‚­ì œ
    if (window.dashboardInstance) {
      try {
        window.dashboardInstance.destroy();
      } catch (e) {
        console.warn('Dashboard destroy failed:', e);
      }
    }
    window.dashboardInstance = null;
    
    // ëª¨ë“  ì°¨íŠ¸ ì»¨í…Œì´ë„ˆ ë¦¬ì…‹
    const chartContainers = document.querySelectorAll('[data-chart-id]');
    chartContainers.forEach(container => {
      container.innerHTML = '<div class="flex items-center justify-center h-full"><i class="fas fa-spinner fa-spin text-gray-400"></i><span class="ml-2">ì°¨íŠ¸ ë¡œë”© ì¤‘...</span></div>';
    });
    
    // ì§§ì€ ì§€ì—° í›„ ì¬ì´ˆê¸°í™”
    setTimeout(() => {
      initializeDashboard();
      
      // ì¬ì´ˆê¸°í™” í›„ ìƒíƒœ ë³µì›
      setTimeout(() => {
        window.loadChartStates();
        dashboardReinitInProgress = false;
        console.log(`âœ… Force reinitialization #${currentCount} completed`);
      }, 500);
    }, 100);
    
  }, 200);
};

// ë‹¨ìˆœí™”ëœ Turbo ì´ë²¤íŠ¸ ì²˜ë¦¬ (ì²« ë¡œë“œ í›„ ì¤‘ë³µ ë°©ì§€)
document.addEventListener('turbo:load', () => {
  if (window.location.pathname === '/dashboard') {
    if (!dashboardFirstInitDone) {
      console.log('ğŸ”„ Turbo load detected for dashboard (FIRST INIT)');
      window.forceDashboardReinit();
      dashboardFirstInitDone = true;
    } else {
      console.log('ğŸ”„ Turbo load detected for dashboard (ALREADY INITIALIZED - SKIPPING)');
      // ë‹¨ìˆœíˆ ìƒíƒœ ë³µì›ë§Œ
      setTimeout(() => {
        window.loadChartStates();
      }, 100);
    }
  } else {
    // ë‹¤ë¥¸ í˜ì´ì§€ë¡œ ì´ë™í•˜ë©´ í”Œë˜ê·¸ ë¦¬ì…‹
    if (dashboardFirstInitDone) {
      console.log('ğŸ“¤ Leaving dashboard - resetting init flag');
      dashboardFirstInitDone = false;
    }
  }
});

// Turbo Frame ë Œë”ë§ ì™„ë£Œ í›„ ì°¨íŠ¸ ì¬ì´ˆê¸°í™” (í˜ì´ì§€ ì´ë™ í›„ì—ë§Œ)
document.addEventListener('turbo:frame-render', (event) => {
  if (event.target.id === 'main-content' && window.location.pathname === '/dashboard') {
    if (!dashboardFirstInitDone) {
      console.log('ğŸ–¼ï¸ Dashboard frame rendered (FIRST INIT)');
      window.forceDashboardReinit();
      dashboardFirstInitDone = true;
    } else {
      console.log('ğŸ–¼ï¸ Dashboard frame rendered (ALREADY INITIALIZED - SKIPPING)');
    }
  }
});

// ë¸Œë¼ìš°ì € ë’¤ë¡œê°€ê¸°/ì•ìœ¼ë¡œê°€ê¸° ê°ì§€ (í˜ì´ì§€ ìºì‹œì—ì„œ ë³µì›)
window.addEventListener('pageshow', (event) => {
  if (event.persisted && window.location.pathname === '/dashboard') {
    console.log('ğŸ”„ Page restored from cache (back/forward) - FORCE REINIT');
    // ë’¤ë¡œê°€ê¸° ì‹œì—ëŠ” ê°•ì œë¡œ ì¬ì´ˆê¸°í™” í•„ìš”
    dashboardFirstInitDone = false;
    window.forceDashboardReinit();
  }
});

// ì°¨íŠ¸ ë¼ì´ë¸ŒëŸ¬ë¦¬ ë³€ê²½ ì‹œ ìƒíƒœ ìë™ ì €ì¥
document.addEventListener('change', (e) => {
  if (e.target.matches('[data-chart-select]')) {
    console.log('ğŸ“Š Chart library changed, saving states...');
    setTimeout(() => {
      window.saveChartStates();
    }, 1000); // ì°¨íŠ¸ê°€ ì™„ì „íˆ ë Œë”ë§ëœ í›„ ì €ì¥
  }
});

// í’€ìŠ¤í¬ë¦° ê¸°ëŠ¥ì„ ìœ„í•œ ì¶”ê°€ ì´ë²¤íŠ¸ ì²˜ë¦¬ (ê¸°ì¡´ ì‹œìŠ¤í…œê³¼ ë³‘í•©)
document.addEventListener('click', (e) => {
  // í’€ìŠ¤í¬ë¦° ë²„íŠ¼ í´ë¦­ ì²˜ë¦¬ë§Œ ì—¬ê¸°ì„œ ì²˜ë¦¬ (ìƒˆë¡œê³ ì¹¨ì€ ê¸°ì¡´ ì‹œìŠ¤í…œ ì‚¬ìš©)
  let fullscreenButton = null;
  if (e.target.hasAttribute('data-chart-fullscreen')) {
    fullscreenButton = e.target;
  } else if (e.target.closest('[data-chart-fullscreen]')) {
    fullscreenButton = e.target.closest('[data-chart-fullscreen]');
  }
  
  if (fullscreenButton) {
    e.preventDefault();
    e.stopPropagation();
    const chartId = fullscreenButton.getAttribute('data-chart-fullscreen');
    console.log('ğŸ“º Fullscreen button clicked for chart:', chartId);
    toggleChartFullscreen(chartId);
    return;
  }
});

// ì°¨íŠ¸ í’€ìŠ¤í¬ë¦° í† ê¸€ í•¨ìˆ˜
function toggleChartFullscreen(chartId) {
  console.log('ğŸ” Toggling fullscreen for chart:', chartId);
  
  // ì—¬ëŸ¬ ë°©ë²•ìœ¼ë¡œ ì°¨íŠ¸ ì»¨í…Œì´ë„ˆ ì°¾ê¸°
  const chartContainer = document.querySelector(`[data-chart-id="${chartId}"]`) || document.getElementById(chartId);
  console.log('Chart container found:', chartContainer);
  
  if (!chartContainer) {
    console.error('Chart container not found:', chartId);
    alert('ì°¨íŠ¸ ì»¨í…Œì´ë„ˆë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤: ' + chartId);
    return;
  }
  
  // ì°¨íŠ¸ wrapper ì°¾ê¸° (ì—¬ëŸ¬ ë°©ë²• ì‹œë„)
  let chartWrapper = chartContainer.closest('.bg-white');
  if (!chartWrapper) {
    chartWrapper = chartContainer.closest('div[class*="bg-white"]');
  }
  if (!chartWrapper) {
    chartWrapper = chartContainer.parentElement;
    while (chartWrapper && !chartWrapper.classList.contains('bg-white')) {
      chartWrapper = chartWrapper.parentElement;
    }
  }
  
  console.log('Chart wrapper found:', chartWrapper);
  
  if (!chartWrapper) {
    console.error('Chart wrapper not found for:', chartId);
    alert('ì°¨íŠ¸ ë˜í¼ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤: ' + chartId);
    return;
  }
  
  // í˜„ì¬ í’€ìŠ¤í¬ë¦° ìƒíƒœ í™•ì¸
  const isFullscreen = chartWrapper.classList.contains('chart-fullscreen');
  console.log('Is currently fullscreen:', isFullscreen);
  
  if (isFullscreen) {
    // í’€ìŠ¤í¬ë¦° ì¢…ë£Œ
    console.log('Exiting fullscreen...');
    exitChartFullscreen(chartWrapper, chartId);
  } else {
    // í’€ìŠ¤í¬ë¦° ì§„ì…
    console.log('Entering fullscreen...');
    enterChartFullscreen(chartWrapper, chartId);
  }
}

// ì§„ì •í•œ í’€ìŠ¤í¬ë¦° ì§„ì… (F11ê³¼ ê°™ì€ ê²½í—˜)
function enterChartFullscreen(chartWrapper, chartId) {
  console.log('ğŸ“º Entering TRUE fullscreen for:', chartId);
  
  // ë¸Œë¼ìš°ì € Fullscreen API ì‚¬ìš©
  if (chartWrapper.requestFullscreen) {
    chartWrapper.requestFullscreen().then(() => {
      setupFullscreenChart(chartWrapper, chartId);
    }).catch((err) => {
      console.error('Fullscreen API ì‹¤íŒ¨, ëŒ€ì²´ ë°©ë²• ì‚¬ìš©:', err);
      fallbackFullscreen(chartWrapper, chartId);
    });
  } else if (chartWrapper.webkitRequestFullscreen) {
    chartWrapper.webkitRequestFullscreen();
    setupFullscreenChart(chartWrapper, chartId);
  } else if (chartWrapper.msRequestFullscreen) {
    chartWrapper.msRequestFullscreen();
    setupFullscreenChart(chartWrapper, chartId);
  } else {
    console.log('Fullscreen API ë¯¸ì§€ì›, ëŒ€ì²´ ë°©ë²• ì‚¬ìš©');
    fallbackFullscreen(chartWrapper, chartId);
  }
}

// ë¸Œë¼ìš°ì € í’€ìŠ¤í¬ë¦° ëª¨ë“œì—ì„œ ì°¨íŠ¸ ì„¤ì •
function setupFullscreenChart(chartWrapper, chartId) {
  console.log('ğŸ¯ Setting up fullscreen chart');
  
  // ì›ë³¸ ìŠ¤íƒ€ì¼ ì €ì¥ (ë³µì›ìš©)
  const chartContainer = chartWrapper.querySelector(`[data-chart-id="${chartId}"]`);
  const chartWrapper_inner = chartWrapper.querySelector('.chart-wrapper');
  
  chartWrapper._originalStyles = {
    wrapper: {
      width: chartWrapper.style.width || '',
      height: chartWrapper.style.height || '',
      padding: chartWrapper.style.padding || '',
      backgroundColor: chartWrapper.style.backgroundColor || '',
      display: chartWrapper.style.display || '',
      flexDirection: chartWrapper.style.flexDirection || ''
    },
    container: chartContainer ? {
      height: chartContainer.style.height || '',
      flex: chartContainer.style.flex || ''
    } : {},
    innerWrapper: chartWrapper_inner ? {
      height: chartWrapper_inner.style.height || ''
    } : {}
  };
  
  // í’€ìŠ¤í¬ë¦° í´ë˜ìŠ¤ ì¶”ê°€
  chartWrapper.classList.add('chart-fullscreen-native');
  
  // í’€ìŠ¤í¬ë¦°ì—ì„œì˜ ìŠ¤íƒ€ì¼ ì ìš©
  chartWrapper.style.width = '100vw';
  chartWrapper.style.height = '100vh';
  chartWrapper.style.padding = '40px';
  chartWrapper.style.backgroundColor = 'white';
  chartWrapper.style.display = 'flex';
  chartWrapper.style.flexDirection = 'column';
  
  // ì°¨íŠ¸ ì»¨í…Œì´ë„ˆ ìŠ¤íƒ€ì¼ ì¡°ì •
  if (chartContainer) {
    chartContainer.style.height = 'calc(100vh - 160px)';
    chartContainer.style.flex = '1';
  }
  
  // í’€ìŠ¤í¬ë¦° ë²„íŠ¼ ì•„ì´ì½˜ ë³€ê²½
  const fullscreenBtn = chartWrapper.querySelector(`[data-chart-fullscreen="${chartId}"]`);
  if (fullscreenBtn) {
    const icon = fullscreenBtn.querySelector('i');
    if (icon) {
      icon.className = 'fas fa-compress-arrows-alt';
    }
    fullscreenBtn.title = 'ì „ì²´í™”ë©´ ì¢…ë£Œ (ESC)';
  }
  
  // í’€ìŠ¤í¬ë¦° ë³€ê²½ ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ
  const fullscreenChangeHandler = () => {
    if (!document.fullscreenElement && !document.webkitFullscreenElement && !document.msFullscreenElement) {
      console.log('ğŸ”™ Exiting fullscreen via browser');
      exitFullscreenChart(chartWrapper, chartId);
      document.removeEventListener('fullscreenchange', fullscreenChangeHandler);
      document.removeEventListener('webkitfullscreenchange', fullscreenChangeHandler);
      document.removeEventListener('msfullscreenchange', fullscreenChangeHandler);
    }
  };
  
  document.addEventListener('fullscreenchange', fullscreenChangeHandler);
  document.addEventListener('webkitfullscreenchange', fullscreenChangeHandler);
  document.addEventListener('msfullscreenchange', fullscreenChangeHandler);
  
  // ì°¨íŠ¸ í¬ê¸° ì¬ì¡°ì •
  setTimeout(() => {
    resizeChart(chartId);
  }, 500);
}

// Fullscreen API ë¯¸ì§€ì› ì‹œ ëŒ€ì²´ ë°©ë²•
function fallbackFullscreen(chartWrapper, chartId) {
  console.log('ğŸ”„ Using fallback fullscreen method');
  
  // ì›ë³¸ ìŠ¤íƒ€ì¼ ì €ì¥ (ë³µì›ìš©)
  const chartContainer = chartWrapper.querySelector(`[data-chart-id="${chartId}"]`);
  const chartWrapper_inner = chartWrapper.querySelector('.chart-wrapper');
  
  chartWrapper._originalStyles = {
    wrapper: {
      position: chartWrapper.style.position || '',
      top: chartWrapper.style.top || '',
      left: chartWrapper.style.left || '',
      width: chartWrapper.style.width || '',
      height: chartWrapper.style.height || '',
      zIndex: chartWrapper.style.zIndex || '',
      backgroundColor: chartWrapper.style.backgroundColor || '',
      padding: chartWrapper.style.padding || ''
    },
    container: chartContainer ? {
      height: chartContainer.style.height || '',
      flex: chartContainer.style.flex || ''
    } : {},
    innerWrapper: chartWrapper_inner ? {
      height: chartWrapper_inner.style.height || ''
    } : {}
  };
  
  // í’€ìŠ¤í¬ë¦° í´ë˜ìŠ¤ ì¶”ê°€
  chartWrapper.classList.add('chart-fullscreen');
  
  // ëª¨ë“  ë‹¤ë¥¸ ìš”ì†Œë“¤ ìˆ¨ê¸°ê¸°
  document.body.style.overflow = 'hidden';
  const rootElements = document.body.children;
  for (let element of rootElements) {
    if (!element.contains(chartWrapper)) {
      element.style.display = 'none';
      element.setAttribute('data-hidden-for-fullscreen', 'true');
    }
  }
  
  // ì°¨íŠ¸ë¥¼ bodyì— ì§ì ‘ ì¶”ê°€ (ì„ì‹œ)
  chartWrapper.style.position = 'fixed';
  chartWrapper.style.top = '0';
  chartWrapper.style.left = '0';
  chartWrapper.style.width = '100vw';
  chartWrapper.style.height = '100vh';
  chartWrapper.style.zIndex = '99999';
  chartWrapper.style.backgroundColor = 'white';
  chartWrapper.style.padding = '40px';
  
  // ESC í‚¤ ì´ë²¤íŠ¸
  const escapeHandler = (e) => {
    if (e.key === 'Escape') {
      exitChartFullscreen(chartWrapper, chartId);
      document.removeEventListener('keydown', escapeHandler);
    }
  };
  document.addEventListener('keydown', escapeHandler);
  
  // í’€ìŠ¤í¬ë¦° ë²„íŠ¼ ì•„ì´ì½˜ ë³€ê²½
  const fullscreenBtn = chartWrapper.querySelector(`[data-chart-fullscreen="${chartId}"]`);
  if (fullscreenBtn) {
    const icon = fullscreenBtn.querySelector('i');
    if (icon) {
      icon.className = 'fas fa-compress';
    }
    fullscreenBtn.title = 'ì „ì²´í™”ë©´ ì¢…ë£Œ (ESC)';
  }
  
  // ì°¨íŠ¸ í¬ê¸° ì¬ì¡°ì •
  setTimeout(() => {
    resizeChart(chartId);
  }, 300);
}

// í’€ìŠ¤í¬ë¦° ì¢…ë£Œ (í†µí•©)
function exitChartFullscreen(chartWrapper, chartId) {
  console.log('ğŸ“± Exiting fullscreen for:', chartId);
  
  // ë¸Œë¼ìš°ì € Fullscreen APIë¡œ ì¢…ë£Œ ì‹œë„
  if (document.exitFullscreen) {
    document.exitFullscreen();
  } else if (document.webkitExitFullscreen) {
    document.webkitExitFullscreen();
  } else if (document.msExitFullscreen) {
    document.msExitFullscreen();
  }
  
  // ì‹¤ì œ í’€ìŠ¤í¬ë¦° ì¢…ë£Œ ì²˜ë¦¬
  exitFullscreenChart(chartWrapper, chartId);
}

// í’€ìŠ¤í¬ë¦° ì •ë¦¬ í•¨ìˆ˜
function exitFullscreenChart(chartWrapper, chartId) {
  console.log('ğŸ”„ Cleaning up fullscreen state for:', chartId);
  
  // ì›ë³¸ ìŠ¤íƒ€ì¼ ë³µì›ì„ ìœ„í•´ ì €ì¥ëœ ê°’ë“¤ ê°€ì ¸ì˜¤ê¸°
  const originalStyles = chartWrapper._originalStyles || {};
  const chartContainer = chartWrapper.querySelector(`[data-chart-id="${chartId}"]`);
  const chartWrapper_inner = chartWrapper.querySelector('.chart-wrapper');
  
  // í’€ìŠ¤í¬ë¦° í´ë˜ìŠ¤ ì œê±°
  chartWrapper.classList.remove('chart-fullscreen', 'chart-fullscreen-native');
  
  // chartWrapper ìŠ¤íƒ€ì¼ ë³µì›
  Object.keys(originalStyles.wrapper || {}).forEach(prop => {
    chartWrapper.style[prop] = originalStyles.wrapper[prop];
  });
  
  // ì°¨íŠ¸ ì»¨í…Œì´ë„ˆ ìŠ¤íƒ€ì¼ ë³µì›  
  if (chartContainer && originalStyles.container) {
    Object.keys(originalStyles.container).forEach(prop => {
      chartContainer.style[prop] = originalStyles.container[prop];
    });
  }
  
  // ë‚´ë¶€ chart-wrapper ìŠ¤íƒ€ì¼ ë³µì›
  if (chartWrapper_inner && originalStyles.innerWrapper) {
    Object.keys(originalStyles.innerWrapper).forEach(prop => {
      chartWrapper_inner.style[prop] = originalStyles.innerWrapper[prop];
    });
  }
  
  // ì €ì¥ëœ ì›ë³¸ ìŠ¤íƒ€ì¼ ì •ë³´ ì‚­ì œ
  delete chartWrapper._originalStyles;
  
  // ëŒ€ì²´ ë°©ë²•ìœ¼ë¡œ ìˆ¨ê¸´ ìš”ì†Œë“¤ ë³µì›
  const hiddenElements = document.querySelectorAll('[data-hidden-for-fullscreen="true"]');
  hiddenElements.forEach(element => {
    element.style.display = '';
    element.removeAttribute('data-hidden-for-fullscreen');
  });
  document.body.style.overflow = '';
  
  // í’€ìŠ¤í¬ë¦° ë²„íŠ¼ ì•„ì´ì½˜ ë³€ê²½
  const fullscreenBtn = chartWrapper.querySelector(`[data-chart-fullscreen="${chartId}"]`);
  if (fullscreenBtn) {
    const icon = fullscreenBtn.querySelector('i');
    if (icon) {
      icon.className = 'fas fa-expand';
    }
    fullscreenBtn.title = 'ì „ì²´í™”ë©´';
  }
  
  // ì°¨íŠ¸ í¬ê¸° ì¬ì¡°ì •
  setTimeout(() => {
    resizeChart(chartId);
  }, 300);
}

// ì°¨íŠ¸ í¬ê¸° ì¬ì¡°ì •
function resizeChart(chartId) {
  console.log('ğŸ“ Resizing chart:', chartId);
  
  const chartContainer = document.querySelector(`[data-chart-id="${chartId}"]`);
  if (!chartContainer) return;
  
  // Chart.js ì°¨íŠ¸ í¬ê¸° ì¡°ì •
  const canvas = chartContainer.querySelector('canvas');
  if (canvas && canvas.chart) {
    canvas.chart.resize();
    console.log('âœ… Chart.js chart resized');
  }
  
  // ApexCharts í¬ê¸° ì¡°ì •
  if (window.ApexCharts) {
    const apexChart = chartContainer.querySelector('.apexcharts-canvas');
    if (apexChart) {
      // ApexCharts ì¸ìŠ¤í„´ìŠ¤ ì°¾ê¸° ë° í¬ê¸° ì¡°ì •
      console.log('âœ… ApexCharts chart resize attempted');
    }
  }
  
  // ECharts í¬ê¸° ì¡°ì •
  if (window.echarts) {
    const echartsDiv = chartContainer.querySelector('[id$="-echarts"]');
    if (echartsDiv) {
      // ECharts ì¸ìŠ¤í„´ìŠ¤ë¥¼ ì°¾ì•„ì„œ resize í˜¸ì¶œ
      const echartsInstance = echarts.getInstanceByDom(echartsDiv);
      if (echartsInstance) {
        setTimeout(() => {
          echartsInstance.resize();
          console.log('âœ… ECharts chart resized:', chartId);
        }, 100);
      }
    }
  }
  
  // ChartManagerë¥¼ í†µí•œ ì°¨íŠ¸ í¬ê¸° ì¡°ì • (ì¶”ê°€ ì•ˆì „ì¥ì¹˜)
  if (window.ChartManager) {
    const chartInfo = window.ChartManager.getChartInfo(chartId);
    if (chartInfo && chartInfo.library === 'echarts') {
      setTimeout(() => {
        const chartData = window.ChartManager.charts.get(chartId);
        if (chartData && chartData.instance && !chartData.instance.isDisposed()) {
          chartData.instance.resize();
          console.log('âœ… ECharts chart resized via ChartManager:', chartId);
        }
      }, 150);
    }
  }
}

// ì°¨íŠ¸ ìƒˆë¡œê³ ì¹¨ (ê¸°ì¡´ ì‹œìŠ¤í…œì´ ì´ë¯¸ ì²˜ë¦¬í•˜ë¯€ë¡œ ì œê±°ë¨)

// ë‹¨ìˆœí™”ëœ ì•ˆì „ì¥ì¹˜: í˜ì´ì§€ ê°€ì‹œì„± ë³€ê²½ ì‹œì—ë§Œ ì²´í¬
document.addEventListener('visibilitychange', () => {
  if (!document.hidden && window.location.pathname === '/dashboard') {
    console.log('ğŸ‘ï¸ Dashboard became visible - checking if reinit needed...');
    
    setTimeout(() => {
      const chartContainers = document.querySelectorAll('[data-chart-id]');
      let needsReinit = false;
      
      chartContainers.forEach(container => {
        const canvas = container.querySelector('canvas');
        if (!canvas || canvas.width === 0) {
          needsReinit = true;
        }
      });
      
      if (needsReinit) {
        console.log('ğŸ“Š Empty charts detected, reinitializing...');
        window.forceDashboardReinit();
      }
    }, 300);
  }
});

// í˜ì´ì§€ ì–¸ë¡œë“œ ì‹œ ì •ë¦¬
window.addEventListener('beforeunload', () => {
  if (dashboardInstance) {
    dashboardInstance.destroy();
  }
});

// ì°¨íŠ¸ ë¼ì´ë¸ŒëŸ¬ë¦¬ ë¹„êµ ëŒ€ì‹œë³´ë“œ í† ê¸€ í•¨ìˆ˜
function toggleChartComparisonTable() {
  const comparisonTable = document.getElementById('detailed-chart-comparison');
  const toggleButton = document.getElementById('chart-comparison-toggle');
  const icon = toggleButton.querySelector('i');
  
  if (comparisonTable.style.display === 'none') {
    comparisonTable.style.display = 'block';
    icon.className = 'fas fa-chevron-up mr-1';
    toggleButton.innerHTML = '<i class="fas fa-chevron-up mr-1"></i>ê°„ë‹¨íˆ ë³´ê¸°';
  } else {
    comparisonTable.style.display = 'none';
    icon.className = 'fas fa-chevron-down mr-1';
    toggleButton.innerHTML = '<i class="fas fa-chevron-down mr-1"></i>ìƒì„¸ ë¹„êµ';
  }
}

// ë¼ì´ì„¼ìŠ¤ íˆ´íŒ í† ê¸€ í•¨ìˆ˜
function toggleLicenseTooltip() {
  const tooltip = document.getElementById('license-tooltip');
  if (tooltip) {
    tooltip.classList.toggle('hidden');
  }
}

// ì°¨íŠ¸ ë¹„êµ ìƒì„¸ ë‚´ìš© í† ê¸€ í•¨ìˆ˜  
function toggleDetailedComparison() {
  const detailSection = document.getElementById('detailed-chart-comparison');
  const toggleBtn = document.querySelector('[onclick="toggleDetailedComparison()"]');
  
  if (detailSection && toggleBtn) {
    const isHidden = detailSection.style.display === 'none';
    detailSection.style.display = isHidden ? 'block' : 'none';
    
    const icon = toggleBtn.querySelector('i');
    const text = toggleBtn.querySelector('.toggle-text');
    
    if (isHidden) {
      icon.className = 'fas fa-chevron-up ml-1';
      text.textContent = 'ì ‘ê¸°';
    } else {
      icon.className = 'fas fa-chevron-down ml-1';  
      text.textContent = 'ìì„¸íˆ ë³´ê¸°';
    }
  }
}

</script>

